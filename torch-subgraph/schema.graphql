# ---------------- USER ----------------
type User @entity(immutable: true) {
  id: ID!
  bets: [Bet!]! @derivedFrom(field: "user")
}

type UserStats @entity(immutable: false) {
  id: ID!
  totalBets: Int!
  totalWon: Int!
  totalStaked: BigInt!
  totalPayout: BigInt!
}

# ---------------- BUCKET ----------------
type Bucket @entity(immutable: false) {
  id: ID!
  aggregationComplete: Boolean!
  totalBets: Int!
  bets: [Bet!]! @derivedFrom(field: "bucketRef")
}

# ---------------- BET ----------------
type Bet @entity(immutable: false) {
  id: ID!
  user: User!
  bucket: Int!
  bucketRef: Bucket!
  stake: BigInt!
  priceMin: BigInt!
  priceMax: BigInt!
  targetTimestamp: BigInt!
  qualityBps: BigInt
  weight: BigInt
  finalized: Boolean
  claimed: Boolean
  actualPrice: BigInt
  won: Boolean
  payout: BigInt
  blockNumber: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}

# ---------------- FEE ----------------
type Fee @entity(immutable: true) {
  id: ID!
  amount: BigInt!
  blockNumber: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}
